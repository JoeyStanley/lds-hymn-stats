---
title: "The First Batch of New Hymns!"
author: "Joey Stanley"
date: "2024-06-25"
date-modified: last-modified
categories: 
  - general
  - frequency
  - new hymns
reference-location: margin
---

```{r, include = FALSE}
knitr::opts_chunk$set(include = FALSE,
                      echo = FALSE,
                      fig.width = 8)
rmarkdown::render("../../_scripts/analysis_functions.Rmd")
library(gt)

# Apply a date stamp
sf <- stamp("June 2", quiet = TRUE)

# get last Sunday
last_sunday <- ymd(floor_date(today(), "week"))
```




```{r}
meetings_since_release <- freqs |> 
    filter(date <= ymd(last_sunday),
           date >= ymd("2024-06-02"))
n_meetings_since_release <- meetings_since_release |> 
    distinct(meeting_id) |> 
    nrow()
n_wards_since_release <- meetings_since_release |> 
    filter(date <= ymd(last_sunday)) |> 
    pull(ward) |> 
    unique() |> 
    length()
n_weeks_since_release <- meetings_since_release |> 
    count(date) |> 
    nrow()
```


On May 30th, the church released the first batch of new hymns. I have done posts on how those hymns have been used during the [first](posts/new_hymns_week1), [second](posts/new_hymns_week2), and [third](posts/new_hymns_week3) weeks since their release. Moving forward, I'll update this blog post with new data as it comes in so that you can get a better look at how hymns are being adopted over several weeks at once. I'll try to update this page weekly until the second batch of hymns comes out in September. Currently I have data from `r n_meetings_since_release` sacrament meetings since June 2nd from `r n_wards_since_release` wards. 

::: callout-note
Note that this blog post change slightly as more data comes in, even from earlier weeks since the release. However, I feel like enough data has been collected that the overall patterns are mostly pretty clear.
:::

But first, here's how much data I have for each week, just so you have an idea of what I'm working with.

```{r, include = TRUE}
meetings_since_release |> 
    distinct(date, meeting_id) |> 
    count(date) |> 
    mutate(date = sf(date)) |> 
    rename(wards = n) |> 
    gt() |> 
    tab_header(title = "Number of wards I have data from, by week",
               subtitle = "Since June 2")
```




## How many wards are singing new hymns each week?

The following plot shows the number of new hymns sung per ward each week since the release of the new hymns.

```{r, include = TRUE, fig.height = 4, fig.width = 6.5}
data_to_plot <- meetings_since_release |> 
    mutate(is_new = hymn_num > 1000 & hymn_num < 2000) |> 
    summarize(n_new = sum(is_new), .by = c(date, ward)) |>
    count(date, n_new) |> 
    filter(n_new <= 2) |> 
    
    # Put the dates in order
    arrange(date) |> 
    # mutate(date = fct_inorder(sf(date))) |> 
    
    mutate(prop = n/sum(n), .by = date) |>
    mutate(n_new = as.factor(n_new))

# Place labels a little above the max from most recent three weeks
# (Will need to raise to four as more dates come in.)
labels <- data_to_plot |> 
    slice_max(order_by = date, n = 3, by = n_new) |> 
    summarize(prop = max(prop), 
              date = max(date),
              .by = n_new) |> 
    mutate(label = case_when(n_new == 0 ~ "no new hymns",
                             n_new == 1 ~ "1 new hymn",
                             n_new == 2 ~ "2 new hymns"))

date_breaks <- data_to_plot |> 
    distinct(date) |> 
    rowid_to_column("week_num") |> 
    filter(week_num %% 2 == 0) |> 
    pull(date)

ggplot(data_to_plot, aes(date, prop, group = n_new, color = n_new)) +
    stat_smooth(formula = "y ~ x", method = "loess", color = "gray85", alpha = 0.25) +
    geom_path() + 
    geom_point() + 
    geom_text(data = labels, aes(y = prop + 0.05, label = label), hjust = 1) + 
    scale_x_date(breaks = date_breaks,
                 date_labels = "%b %d") +
    scale_y_continuous(expand = expansion(0, 0.01),
                       breaks = seq(0, 1, 0.1),
                       labels = scales::percent) +
    scale_color_manual(values = c(ptol_blue, ptol_red, ptol_green)) + 
    theme_minimal() +
    labs(x = "number of new hymns per sacrament meeting",
         y = "percentage of wards",
         title = "Percentage of wards singing new hymns since their release",
         subtitle = paste("Based on data from", n_wards_since_release, "wards"),
         fill = "date") + 
    theme(legend.position = "none")
```

Since the first week, the number of wards that have sung new hymns has been remarkably stable. Typically, only about a quarter to a third of wards sing new hymns each week. A small number sing two each week. There are rare cases of three or more, but they are so infrequent, I've left them off this chart. 

For each number of new hymns per week, I've overlaid a smooth to show the general trend. What I like about it is that is gives a shaded area showing where the proportions typically occur. Anything outside of those could be considered exceptional in some way. Currently, there is one week that stands out: August 4th. For some reason, that was the week where the fewest wards sang new hymns. I have no explanation for why that would be. Even when competing with holidays like [Father's Day](/posts/fathers_day), the [martyrdom of Joseph Smith](/posts/martyrdom), and [Pioneer Day](/posts/pioneer_day), the number of new hymns per week stayed consistent. But a random week in early August had fewer---albeit by a small margin. 


```{r}
n_weeks_since_release
wards_with_complete_data <- meetings_since_release |> 
    summarize(n_new = sum(hymn_num > 1000 & hymn_num < 2000), .by = c(ward, date)) |> 
    arrange(ward, date) |> 
    
    # only wards with (nearly) complete datasets
    add_count(ward, name = "n_weeks") |> 
    filter(n_weeks >= n_weeks_since_release * 0.9) |> 
    
    summarize(weeks_with_new = sum(n_new >= 1), .by = ward) |> 
    count(weeks_with_new) |> 
    mutate(prop = n/sum(n)) |> 
    print()
n_wards_with_complete_data <- meetings_since_release |> 
    distinct(date, ward) |> 
    count(ward) |> 
    filter(n == 2) |> 
    nrow() |> 
    print() 
ggplot(wards_with_complete_data, aes(weeks_with_new, prop)) + 
    geom_col() + 
    scale_x_continuous(name = "weeks with a new hymn",
                       breaks = 0:100) + 
    scale_y_continuous(labels = scales::percent, 
                       name = "percent of wards", 
                       expand = expansion(0, 0)) + 
    labs(title = "How many weeks since June 2 have wards included new hymns?",
         subtitle = paste("Based on the", n_wards_with_complete_data, "wards with >90% complete data")) + 
    theme_minimal()
```

However, a good chunk of my data comes from single-week contributions from various wards, so just just because a ward didn't sing a new hymn this week doesn't mean they haven't done any yet. To see what proportion of wards have introduced new hymns up to this point, I took a look at the `r n_wards_with_complete_data` wards that I have data from from at least 90% of the weeks since the first batch of hymns came out. About 25% of them haven't sung new hymns at all yet. Otherwise, the typical number of weeks that wards have sung new hymns since June 2nd is about four. But, that's only based on `r n_wards_with_complete_data` wards and not the complete dataset, so take that number with a grain of salt.


## What hymns are most popular?

It should come as no surprise that the most popular hymn in this new batch is <hymn>Come, Thou Fount of Every Blessing (#1001)</hymn>. But just how popular is it? The following table shows the new hymns in order of how often they've been sung. The percent column shows what percentage of wards each hymn has been sung in as congregational hymns since these hymns have been released. [Note that these numbers might be slightly inflated because some wards have sung the more popular hymns more than once since June 2nd.]{.aside}

```{r, include = TRUE}
freqs |> 
    filter(date >= ymd("2024-06-01")) |> 
    cleveland_plot(return = "table") |> 
    mutate(hymn_num = as.numeric(as.character(hymn_num))) |> 
    full_join(name_num_lookup, by = c("hymn_name", "hymn_num")) |> 
    filter(hymn_num > 1000, hymn_num < 2000) |> 
    mutate(percent_wards = scales::percent(round(n_weeks_since_release / every_x_weeks, 3))) |> 
    select(Hymn = label, `percent of wards` = percent_wards) |> 
    
    gt() |> 
    tab_header(title = "Approximate percentage of wards new hymns have been sung in",
               subtitle = "Since June 2")
```

Overall then, it seems like the hymns have been pretty well-incorporated into regular singing. An overwhelming majority of wards have sung <hymn>Come, Thou Fount of Every Blessing (#1001)</hymn> since June 2, which is pretty remarkable. Surely the novelty will wear off a little bit, but if the current pace continues, then wards will sing it 3--4 times a year, or once every 13 weeks. For reference, before June 2nd, the most common hymn was <hymn>I Stand All Amazed (#193)</hymn> and was sung about once every 19 weeks per ward. The other hymns have been adopted with varying amounts of enthusiasm. We'll wait until December to see how the new Christmas ones get used. 

(For a complete version of this table that includes all hymns, see [here](/overview.qmd).)


## What hymns are most popular each week?

Now that we're several weeks past the release of this first batch of hymns, we can start to see a glimpse of how the adoption of these new hymns has ebbed and flowed and how each hymn has been introduced. The figure below shows what proportion of wards sang what hymns each week, *given that they sang a new hymn that week*. So, we're only focused on wards that have used these hymns. 


```{r, include = TRUE, warning = FALSE, message = FALSE, fig.height = 8, fig.width = 8}
meetings_since_release |> 
    filter(hymn_num > 1000, hymn_num < 2000) |>  
    count(date, hymn_num, name_num) |> 
    
    # pivot and stuff to get zeros
    pivot_wider(names_from = date, values_from = n, values_fill = 0) |> 
    pivot_longer(cols = -c(hymn_num, name_num), names_to = "date", values_to = "n") |>
    mutate(date = ymd(date)) |> 
    
    # put them in order
    arrange(hymn_num) |> 
    mutate(name_num = fct_inorder(name_num)) |> 
    
    # Put the dates in order
    arrange(date) |> 
    mutate(date = date) |> 
    
    # proportions per week
    mutate(prop = n/sum(n), .by = date) |> 
    
    ggplot(aes(date, prop, group = name_num)) + 
    geom_path() + 
    geom_point() + 
    scale_x_date(date_breaks = "2 weeks", date_labels = "%m/%d") +
    scale_y_continuous(labels = scales::percent) + 
    facet_wrap(~name_num, ncol = 2) + 
    labs(title = "Proportion of wards singing new hymns by week",
         subtitle = "Of the sacrament meetings with new hymns",
         x = "date",
         y = "proportion of wards") + 
    theme_bw()

```

<hymn>Come, Thou Fount of Every Blessing (#1001)</hymn> was most popular during the first week. Of the wards that sang new hymns, two thirds of them sang it on June 2nd. My guess is we will never see a hymn hit that kind of popularity again, with the possible exception of new holiday hymns. Since then, the popularity of <hymn>Come, Thou Fount of Every Blessing (#1001)</hymn> has gone down. It went through a very tidy rise and fall, and then suddenly on August 25, it saw a huge spike again. Perhaps a lot of wards are singing it a second time now.

There are a few other major trends so far. <hymn>As Bread is Broken (#1007)</hymn> was very popular on June 16th, Father's day. A common trend was to sing Father's Day songs for opening and closing hymns and that hymn as the sacrament hymn. Also, <hymn>It Is Well With My Soul (#1003)</hymn> got a little more popular July 14th and has been more popular since then. <hymn>His Eye Is on the Sparrow (#1005)</hymn> saw a spike on July 28th and appears to be more popular since then. Finally, <hymn>I Will Walk with Jesus (#1004)</hymn> wasn't very popular during the first two weeks, but it has been since then and was most popular on August 11th.

## When during meetings are these hymns sung?

We can see when these hymns tend to be sung and get an overall look at the popularity of the first batch of hymns. 

```{r, include = TRUE}
meetings_since_release |> 
    filter(hymn_num > 1000, hymn_num < 2000) |> 
    count(name_num, hymn_num, type) |> 
    mutate(n = round(n/sum(n), 2), 
           n = scales::percent(n),
           .by = name_num) |> 
    pivot_wider(names_from = type, values_from = n, values_fill = "0%") |> 
    arrange(hymn_num) |> 
    select(-hymn_num) |> 
    select(name_num, Opening, Sacrament, Intermediate, Closing) |> 
    rename(`New Hymn` = name_num) |> 
    gt() |> 
    tab_header(title = "When are new hymns sung in sacrament meeting?",
               subtitle = "Since June 2")
```

We're already starting to see that each hymn has its own story. Unsurprisingly, the hymns that are most likely to be sacrament hymns are <hymn>As Bread is Broken (#1007)</hymn>, <hymn>Bread of Life, Living Water (#1008)</hymn>, and <hymn>Gethsemane (#1009)</hymn>, with that last one being sung pretty often elsewhere in the meeting. <hymn>Think a Sacred Song (#1006)</hymn> appears to be evenly split between all three slots, but I have only seen it sung in a few wards so that may change once more data comes in. <hymn>Come, Thou Fount of Every Blessing (#1001)</hymn> is about as likely to be an opening hymn as a closing hymn. Two hymns are most common as closing hymns, <hymn>It Is Well with My Soul (#1003)</hymn> and <hymn>His Eye Is on the Sparrow (#1005)</hymn>, though both are pretty common as opening and intermediate hymns as well. The last two hymns, <hymn>I Will Walk with Jesus (#1004)</hymn> and especially <hymn>When the Savior Comes Again (#1002)</hymn>, are most commonly sung as intermediate hymns.


## Conclusion

This first batch of hymns only came out recently, but we're starting to see some trends already. Again, this is only based on `r n_meetings_since_release` sacrament meetings from `r n_wards_since_release` wards. It's not an insignificant amount of data, but it is just a sliver of the many wards across the country and the world. As always, I'm collecting more data and if you'd like to contribute your ward's data, you can do so [here](/contribute.html).

