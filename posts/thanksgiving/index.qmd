---
title: "What hymns are sung around Thanksgiving?"
description: ""
author: "Joey Stanley"
date: 2023-11-04
date-modified: last-modified
categories:
  - holidays
  - frequency
---

```{r, include = FALSE}
knitr::opts_chunk$set(include = FALSE,
                      echo = FALSE)
rmarkdown::render("../../_scripts/analysis_functions.Rmd")
freqs2024 <- freqs |> 
    filter(year == 2024)
freqs <- freqs |> 
    filter(year < 2024)
```

```{r}
freqs %>%
    count(country, sort = TRUE) %>%
    mutate(prop = n/sum(n))
freqs %>%
    filter(month == 11, 
           country == "United States") %>%
    count(meeting_id)
```

::: callout-tip
This was originally posted in November 2023. Since then, I have collected a lot more data. The bulk of this post has been updated to reflect additional data that has been collected from 2023, but does not include data from 2024. The analysis of 2024 has been added to the bottom of the page. 
:::

Thanksgiving in the United States is coming up, and many wards sing hymns to reflect the season. What hymns are sung around Thanksgiving? When does the Thanksgiving season start? What trends are there within November? In this post, I'll only look at the hymns that come from wards in the United States, which is about 84% of the full dataset. When focusing on November, I'll be drawing from data from the 1,472 sacrament meetings.[I gratefully acknowledge [Samuel Bradshaw](https://singpraises.net) for sharing his very large dataset with me!]{.aside}

## What are the Thanksgiving hymns?

The Table of Contents in the front of the hymnal doesn't have a dedicated section for Thanksgiving, but there is a "Praise and Thanksgiving" section, which includes hymns 62--96. In my mind though, the unofficial list of Thanksgiving hymns are hymns 91 through 95. This checks out with the "Thanksgiving" entry in the Topics index. The Topics index also recommends looking at the "Gratitude" entry, which lists an additional 22 hymns. So, the question then is this: what hymns are *actually* sung around Thanksgiving?

```{r}
gratitude_hymns <- c(62, 219, 158, 138, 65, 167, 94, 241, 154, 91, 92, 35, 297, 76, 78,
                     306, 222, 193, 139, 95, 93, 61, 66, 112, 227, 247, 19)
```

Let's take a look at what is sung in November in the United States. @fig-thanksgiving_freqs shows the hymns that are the most common in November. As expected, the five "Thanksgiving" hymns (hymns 91--95), which are highlighted in red, are on this list. We also see two other hymns that are about gratitude, <hymn>Count Your Blessings (#241)</hymn> and <hymn>Because I Have Been Given Much (#219)</hymn>. Finally we see <hymn>All Creatures of Our God and King (#62)</hymn>, a hymn that is probably more about praise than gratitude but it fits. So, of the 22 hymns listed in the back of the hymnal under the Gratitude entry, only three of them surface as being sung more in November than in other months.

```{r, include = TRUE, fig.height = 2.5, fig.width = 6.5}
#| label: fig-thanksgiving_freqs
#| fig-cap: Most common hymns in November (excluding sacrament hymns)

library(ggtext)
unique_thanksgiving_meetings <- freqs %>%
    filter(country == "United States") %>%
    get_n_distinct_meetings()
freqs %>%
    mutate(month = month(date),
           day   = day(date)) %>%
    filter(month == 11, 
           country == "United States",
           !hymn_num %in% 169:196) %>%
    add_count(hymn_num) %>%
    mutate(is_thanksgiving = hymn_num %in% 91:95) %>%
    cleveland_plot(filter_n = 50, 
                   x_buffer = 0.5, breaks = 0.2,
                   unique_meetings = unique_thanksgiving_meetings,
                   extra_cols = is_thanksgiving, color = is_thanksgiving) +
    scale_color_manual(breaks = c("FALSE", "TRUE"),
                       labels = c("Hymns 91–95", "other hymns"),
                       values = c("gray30", ptol_blue),
                       name = NULL) + 
    scale_x_continuous(breaks = seq(0, 1, 0.2),
                       expand = expansion(0, c(0, 0.3))) + 
    labs(title = "Most common hymns in November (in the United States)",
         subtitle = "Includes <span style = 'color: #4477AA;'>Hymns 91–95</span> and <span style = 'color: #4d4d4d;'>other hymns</span>",
         x = "number of times sung per November per ward") + 
    theme(plot.subtitle = element_markdown(),
          legend.position = "none")
    
```

::: {.callout-caution collapse="true"}
### Stats for nerds :)

```{r, cache = TRUE, eval = FALSE}
davies_method(month == 11, .add_chisq = TRUE) %>%
    filter(chisq_p < 0.001/nrow(.))
```

These eight hymns shown in @fig-thanksgiving_freqs are not only the most frequent hymns in November generally, but they're also eight of the nine whose increased frequency in November is statistically significant. For each hymn, I ran a $\chi^2$ test comparing how often it occurs in November to the other 11 months of the year. A sample table for <hymn>Come, Ye Thankful People (#94)</hymn> looks like this:

|                                       | Hymn 94 | All other hymns |
|--------------------------------------:|--------:|----------------:|
| Number of times sung in November      |   313   |            6962 |
| Number of times not sung in November  |    44   |           71045 |

The $\chi^2$ suggests that the association between Hymn 94 and being sung in November is statistically significant ($\chi^2$ = 2607.555, df = 1, $p$ < 0.001).

```{r}
freqs %>%
    mutate(within_range = month == 11,
           this_hymn = hymn_num == 94,
           country == "United States") %>%
    count(within_range, this_hymn) %>%
    filter(!is.na(within_range)) %>%
    print()

freqs %>%
    mutate(within_range = month == 11,
           this_hymn = hymn_num == 94,
           country == "United States") %>%
    infer::chisq_test(within_range ~ this_hymn)
```

However, I had to do that for all 242 hymns that were ever sung in November in this sample. So, to avoid the potential of false positives when running that many independent tests, I decided to do a Bonferroni correction, so only hymns that had a *p*-value less than $0.001 / 242$ ≈ 0.00000413 were considered statistically significant. I know Bonferroni is known to be a bit harsh of a penalty, but in this case it seems to work well. 

(I'll be honest, I'm not sure if $\chi^2$-tests should be done with the sample size is so large or if they're so disproportionate. Please let me know if there's a different test I could use!)

For what it's worth a handful of hymns were statistically *less* likely to be sung in November compared other months. They are mostly ones with clear connections to other holidays: <hymn>Silent Night (#203)</hymn> (popular around [Christmas](/posts/Christmas)), <hymn>Ring Out, Wild Bells (#215)</hymn> (popular around [New Years](/posts/new-years)), <hymn>Home Can Be a Heaven on Earth (#298)</hymn> (popular around [Mother's Day](/posts/mothers_day)), <hymn>America the Beautiful (#338)</hymn> (popular around the [4th of July](/posts/4th_of_july)), <hymn>Come, Come, Ye Saints (#30)</hymn>, <hymn>They, the Builders of the Nation (#36)</hymn>, and <hymn>Carry On (#255)</hymn> (all popular around [Pioneer Day](/posts/pioneer_day)), and <hymn>Come, Listen to a Prophet's Voice (21)</hymn> (popular around the October [General Conference](/posts/general_conference)).



```{r}
single_hymn_lookup(21)
```

:::

```{r}
davies_method(month == 11, .df = filter(freqs, hymn_num %in% 169:196), .add_chisq = TRUE)
```

For what it's worth, I've excluded sacrament hymns in @fig-thanksgiving_freqs and I will for the rest of this blog post. One reason is because they distract from the real patterns that occur. <hymn>I Stand All Amazed (#193)</hymn> was about as common in November as <hymn>Count Your Blessings (#241)</hymn> was. Does that mean it's a Thanksgiving hymn? Probably not. It's just a really common hymn and it's likely to be sung any time of the year. Another reason is because no sacrament hymn is sung in November statistically significantly more than you'd expect if they were evenly distributed throughout the year.

Just to show that the other 19 hymns listed in the "Gratitude" entry in the back of the hymnal were not popular around Thanksgiving, let's look at how often each of the 27 total hymns we've discussed so far are sung throughout the year. @fig-thanksgiving_annual shows this data. From left to right (within each panel), we have the first week of the year to the last week of the year. Higher points on the plot mean the hymn was sung more that week. Each of the 22 gratitude and Thanksgiving hymns is in its own panel, in order of hymn number. I've put a pink line where Thanksgiving typically falls in the year to give a point of reference. 

```{r, include = TRUE, fig.height = 20, fig.width =  6.5}
#| label: fig-thanksgiving_annual
#| fig-cap: Annual trends of 27 gratitude and Thanksgiving hymns 
freqs %>%
    filter(hymn_num %in% gratitude_hymns,
           country == "United States") %>%
    arrange(hymn_num) %>%
    mutate(name_num = fct_inorder(name_num)) %>%
    count(name_num, week) %>%
    ggplot(aes(week, n, group = name_num)) + 
    geom_vline(xintercept = 47.5, color = "pink") + 
    geom_point() + 
    geom_path() + 
    scale_x_continuous(breaks = seq(0, 60, 10)) +
    facet_wrap(~name_num, ncol = 2) + 
    labs(title = "Annual trends for Thanksgiving and gratitude hymns",
         subtitle = "Thanksgiving marked in <span style = 'color: #FFC0CB;'>pink</span>",
         x = "week of the year",
         y = "number of times sung (in this sample)") + 
    theme_bw() + 
    theme(plot.subtitle = element_markdown())
```

@fig-thanksgiving_annual makes it pretty clear that hymns 91--95 really are mostly sung in November and really not very often outside of November. The others that made the cut as being Thanksgiving hymns have a burst of currency in November, but not quite as large. <hymn>All Creatures of Our God and King (#62)</hymn> is also common around Easter and <hymn>Because I Have Been Given Much (#219)</hymn> and <hymn>Count Your Blessings (#241)</hymn> are common all year but especially in November. All the other hymns in @fig-thanksgiving_annual either peak at other times of the year (like [Pioneer Day](/posts/pioneer_day) or [General Conference](/posts/general_conference)) and/or have no apparent jump in frequency in November whatsoever. 

Looking at this plot, I'll speculate a little bit about what goes on in music coordinators' heads as they decide what hymns to sing. If they're familiar with the hymnal already, they may knows that hymns 91--95 are Thanksgiving hymns. They choose one of those, except maybe <hymn>Father, They Children to Thee Now Raise (#91)</hymn> because it's unfamiliar, too difficult to play for the organist, or some other reason. If they think outside the box, they draw on one or more other well-known hymns (<hymn>All Creatures of Our God and King (#62)</hymn>, <hymn>Because I Have Been Given Much (#219)</hymn>, and <hymn>Count Your Blessings (#241)</hymn>) to fill out their November. If the music coordinator is not as familiar with the hymnal, they may turn to the Topics Index and see hymns 91--95 in the Thanksgiving entry, and go from there. It appears that very few people turn to the "Gratitude" section of the hymnal. Again, this is purely speculation; I have never been a music coordinator, so I've never been in a position to regularly choose hymns. But if more people did use these other 19 hymns, we should see more of these hymns being sung in November. 

I'll end this section with an observation that <hymn>We Thank Thee, O God, for a Prophet (#19)</hymn> has not been mentioned at all. It does not come out as being more common in November and it is not listed in the Gratitude or Thanksgiving entries in the topics index at the back of the hymnal. I've already shared my feelings about this hymn when I talked about [General Conference hymns](/posts/general_conference) how it should be thought of as a hymns of praise and thanksgiving rather than a hymn about prophets. Again, changing the title to, simply, "We Thank Thee, O God," might draw people's attention away from the first line and more to the overall theme. @fig-we_thank_thee here shows the popularity of <hymn>We Thank Thee, O God, for a Prophet (#19)</hymn> over the year and you can see that it's no more popular in November than it is in pretty much any other week of the year.

```{r, include = TRUE, fig.height = 2}
#| label: fig-we_thank_thee
#| fig-cap: Frequency of "We Thank Thee, O God, for a Prophet" over the year. 
freqs %>%
    filter(country == "United States",
           hymn_num == 19) %>%
    count(week) %>%
    ggplot(aes(week, n)) + 
    geom_vline(xintercept = 47.5, color = "pink") + 
    geom_point() + 
    geom_path() + 
    scale_x_continuous(breaks = seq(0, 60, 10)) +
    labs(title = "Annual trend for We Thank Thee, O God, for a Prophet",
         subtitle = "Thanksgiving marked in <span style = 'color: #FFC0CB;'>pink</span>",
         x = "week of the year",
         y = "times sung") + 
    theme_bw() + 
    theme(plot.subtitle = element_markdown())
```

```{r}
single_hymn_lookup(19)
```

::: callout-tip
### Recommendation to music coordinators

Try singing <hymn>We Thank Thee, O God, for a Prophet (#19)</hymn> right before Thanksgiving!

:::


## How many Thanksgiving hymns do wards sing in November?

```{r}
freqs %>%
    filter(month == 11, 
           !ward %in% c("Anonymous"),
           country == "United States",
           !hymn_num %in% 169:196) %>%
    cleveland_plot(return = "table", unique_meetings = unique_thanksgiving_meetings)
```

```{r}
wards_with_complete_months <- freqs %>%
    filter(month == 11, country == "United States",
           !ward %in% c("Unknown", "Anonymous")) %>%
    unite(month_year, month, year, remove = FALSE) %>%
    group_by(ward, month_year, date) %>%
    count() %>%
    group_by(ward, month_year) %>%
    count() %>%
    ungroup() %>%
    filter(n >= 4) %>%
    print()

freqs %>%
    filter(country == "United States",
           !ward %in% c("Unknown", "Anonymous")) %>%
    unite(month_year, month, year, remove = FALSE) %>%
    semi_join(wards_with_complete_months, by = c("ward", "month_year")) %>%
    group_by(ward, month_year) %>%
    summarize(has_91 = sum(hymn_num == 91),
              has_92 = sum(hymn_num == 92),
              has_93 = sum(hymn_num == 93),
              has_94 = sum(hymn_num == 94),
              has_95 = sum(hymn_num == 95)) %>%
    ungroup() %>%
    summarize(across(starts_with("has"), mean))
```

Going back to @fig-thanksgiving_freqs, we see that <hymn>Come, Ye Thankful People (#94)</hymn> is sung in about 70.3% of wards as a congregational hymn at least some time during the month of November. <hymn>Prayer of Thanksgiving (#93)</hymn> is about 62.6% and <hymn>For the Beauty of the Earth (#92)</hymn> is (57.1%). This interpretation works because most wards sing these hymns more more than once a year, and they're unlikely to repeat the hymn within the month of November. When I first saw these numbers, I actually thought they were a little low. I figured pretty much every ward in the US would sing some of these hymns. I guess not everyone sings Thanksgiving hymns around Thanksgiving!

```{r}
nrow(wards_with_complete_months)
wards_with_complete_months %>%
    count(ward) %>%
    nrow()
```


So the question then is this: how many wards sing *at least one* of these five (or eight) Thanksgiving songs in November? For this question, I'll only draw from the wards that have contributed data from the entire month of November for a given year. I currently have 273 Novembers worth of data from 138 different wards. 

```{r}
thanksgiving_hymns_per_ward <- freqs %>%
    filter(country == "United States",
           !ward %in% c("Anonymous")) %>%
    unite(month_year, month, year, remove = FALSE) %>%
    semi_join(wards_with_complete_months, by = c("ward", "month_year")) %>%
    group_by(ward, month_year) %>%
    summarize(one_of_the_five = sum(hymn_num %in% 91:95),
              one_of_the_eight = sum(hymn_num %in% c(91:95, 241, 219, 62))) %>%
    print()
thanksgiving_hymns_per_ward %>%
    ungroup() %>%
    count(one_of_the_five) %>%
    mutate(prop = n/sum(n)) |> 
    mutate(cumsum = cumsum(prop))
```

Focusing on the five prototypical Thanksgiving hymns (hymns 91--95), @fig-one_of_the_five shows how many of them a ward is likely to sing in November. The most common scenario (a little less than a third of the wards) is that only two of them are sung. But, a fair number of wards sing three or four of them. Less common is one or even all five. To my surprise, 10.6% of wards in the US don't sing any of these Thanksgiving hymns in November. But that means that 89.4% of wards *do*, which is a lot. And, yes, there were two wards that had more than five. One ward in 2016 sang <hymn>Now Thank We All Our God (#95)</hymn> as the closing hymn two weeks in a row. Another ward sang <hymn>For the Beauty of the Earth (#92)</hymn> three times in four weeks in 2015. 

```{r, include = TRUE, fig.height = 3}
#| label: fig-one_of_the_five
#| fig-cap: How many canonical Thanksgiving hymns does a ward sing in November? 
thanksgiving_hymns_per_ward %>%
    ungroup() %>%
    count(one_of_the_five) %>%
    mutate(prop = n/sum(n)) %>%
    ggplot(aes(one_of_the_five, prop)) + 
    geom_col() + 
    geom_text(aes(label = scales::percent(round(prop, 3))), nudge_y = 0.02) + 
    scale_x_continuous(expand = expansion(0, 0),
                       breaks = 0:7) + 
    scale_y_continuous(expand = expansion(0, c(0, 0.05)),
                       labels = scales::percent_format()) +
    labs(x = "number of Thanksgiving hymns",
         y = "percent of wards") + 
    theme_minimal()
```
Let's do the exact same thing, but include the three "honorary mention" Thanksgiving hymns (<hymn>All Creatures of Our God and King (#62)</hymn>, <hymn>Because I Have Been Given Much (#219)</hymn>, and <hymn>Count Your Blessings (#241)</hymn>) into the mix. @fig-one_of_the_eight shows that data. Singing two to four of these eight is the most common possibility[When I originally wrote this post in 2023, two hymns was the most likely scenario. But after additional data collection in 2024 from sacrament meetings in 2023, and fixing a bug in the code, it is now clear between two and four.]{.aside}, but odds are good that perhaps one or two wards in your stake will sing five of them. A few especially thankful wards sang six or seven of these Thanksgiving hymns But still, to my surprise, 5.1% of wards didn't sing any of these eight hymns in the month of November at all. But, on the flip side, 94.9% of wards sing at least one of them. 

```{r, include = TRUE, fig.height = 3}
#| label: fig-one_of_the_eight
#| fig-cap: How many total Thanksgiving hymns does a ward sing in November? 
thanksgiving_hymns_per_ward %>%
    ungroup() %>%
    count(one_of_the_eight) %>%
    mutate(prop = n/sum(n)) %>%
    ggplot(aes(one_of_the_eight, prop)) + 
    geom_col() + 
    geom_text(aes(label = scales::percent(round(prop, 3))), nudge_y = 0.02) + 
    scale_x_continuous(expand = expansion(0, 0),
                       breaks = 0:7) + 
    scale_y_continuous(expand = expansion(0, c(0, 0.05)),
                       labels = scales::percent_format()) +
    labs(x = "number of Thanksgiving and top three gratitude hymns",
         y = "percent of wards") + 
    theme_minimal()
```

```{r}
thanksgiving_hymns_per_ward %>%
    filter(one_of_the_five > 5)

freqs %>%
    filter(ward == "Castro Valley 1st Ward",
           month == 11, 
           year == 2016) %>%
    # count(name_num) %>%
    print()

freqs %>%
    filter(ward == "Kanesville Ward",
           month == 11, 
           year == 2015) %>%
    # count(name_num, sort = TRUE) %>%
    filter(hymn_num == 92) %>%
    print()
```



## Patterns within the Thanksgiving "season"

Now that we've seen what hymns are considered Thanksgiving hymns and how many are sung each year in a ward, let's dive a little deeper into November and see if we can uncover some more patterns. 

```{r}
thanksgivings <- c(              "11-27-2003",               "11-25-2004", "11-24-2005", "11-23-2006", "11-22-2007",
                                 "11-27-2008", "11-26-2009", "11-25-2010", "11-24-2011", "11-22-2012", 
                   "11-28-2013", "11-27-2014", "11-26-2015",               "11-24-2016", "11-23-2017", "11-22-2018", 
                   "11-28-2019",               "11-26-2020", "11-25-2021", "11-24-2022", "11-23-2023")
thanksgiving_lookup <- tibble(thanksgiving_day = mdy(thanksgivings)) %>%
    mutate(year = year(thanksgiving_day)) %>%
    print()
```


```{r}
# [This](https://en.wikipedia.org/wiki/Thanksgiving_(United_States)#Table_of_dates_(1946–2057)) handy Wikipedia table shows that Thankssgiving is between the 22nd and the 28th, and is either during week 47 or 48.
weeks_until <- freqs %>%
    filter(country == "United States",
           hymn_num %in% c(62, 219, 241, 91:95),
           month == 11) %>%
    left_join(thanksgiving_lookup, by = "year") %>%
    mutate(days_until = thanksgiving_day - date,
           weeks_until = ceiling(make_difftime(days_until*60*60*24, unit = "week"))) %>%
    print()
```

@fig-within_november below shows the within-November trends for each of these eight Thanksgiving hymns. This is basically @fig-thanksgiving_annual above but zoomed in to just show four weeks and just these eight hymns. There are a few small changes though. First, rather than group the data by week of the year, I've grouped the data by the number of Sundays leading up to Thanksgiving. So, the Sunday before Thanksgiving would be 1, the second Sunday before Thanksgiving, would be 2, and so on. The [Sunday after Thanksgiving](/posts/week-after-thanksgiving) is a 0. Second, rather than show the raw count of how many wards have sung that hymn (which is an arbitrary number dependent on how much data I have), I've shown what percentage of the time that particular hymn is sung per week. In other words, the totals within each panel of @fig-within_november add up to 100%. 

```{r, include = TRUE, fig.height = 6}
#| label: fig-within_november
#| fig-cap: The eight Thanksgiving hymns and when they're sung in November
weeks_until %>%
    arrange(hymn_num) %>% 
    mutate(name_num = fct_inorder(name_num)) %>%
    count(name_num, weeks_until) %>%
    mutate(prop = n/sum(n), .by = name_num) %>%
    
    # print() %>%
    ggplot(aes(weeks_until, prop, group = name_num)) + 
    geom_path() + 
    geom_point() + 
    scale_x_reverse() + 
    scale_y_continuous(expand = expansion(0, c(0.01, 0.05)),
                       breaks = seq(0, 0.6, 0.1),
                       limits = c(0, 0.6),
                       labels = scales::percent_format()) +
    facet_wrap(~name_num, ncol = 2) + 
    labs(x = "weeks until Thanksgiving",
         y = "percent") + 
    theme_bw()
```

In this figure, we can see some pretty interesting trends. First off, each of these eight hymns were sung by at least one ward in each month of November. In other words, there are no gaps in the data. Second, we see that almost all hymns peak the Sunday before Thanksgiving. This is especially true of the more popular hymns (hymns 92--95), but also applies to 91 and 219. In two cases, <hymn>All Creates of Our God and King (#62)</hymn> and <hymn>Count Your Blessings (#241)</hymn>, we don't see a spike. Instead, they're equally likely whether it be two weeks before Thanksgiving, the Sunday right before, or the Sunday after. 

The issue with this plot is that there's a confounding factor: how likely Thanksgiving hymns are sung within November. The reason why most of the hymns spike the Sunday before Thanksgiving is simply because that's when Thanksgiving hymns are most likely to be sung. @fig-prop_wards_per_week shows what percentage of US wards sing at least one Thanksgiving hymn by week leading up to Thanksgiving. Unsurprisingly, the Sunday before Thanksgiving is the most common time to sing any of these hymns. So, it makes sense then that, for any Thanksgiving hymn, the most common week to sing it is the Sunday before Thanksgiving. 

```{r, include = TRUE, fig.height = 2}
#| label: fig-prop_wards_per_week
#| fig-cap: Percentage of wards that sing at least one Thanksgiving hymn by week
freqs %>%
    filter(country == "United States",
           month == 11) %>%
    left_join(thanksgiving_lookup, by = "year") %>%
    mutate(days_until = thanksgiving_day - date,
           weeks_until = ceiling(make_difftime(days_until*60*60*24, unit = "week"))) %>%
    mutate(is_thanksgiving = hymn_num %in% c(91:95, 62, 241, 219)) %>%
    summarize(n_thanksgiving = sum(is_thanksgiving, na.rm = TRUE), .by = c(meeting_id, weeks_until)) %>%
    summarize(n = n(),
             include_thanksgiving = sum(n_thanksgiving > 0),
             .by = weeks_until) %>%
    mutate(prop = include_thanksgiving / n) %>%
    # print()
    ggplot(aes(weeks_until, prop)) +
    geom_path() +
    geom_point() +
    scale_x_reverse() +
    scale_y_continuous(expand = expansion(0, c(0.01, 0.05)),
                       breaks = seq(0, 1, 0.1),
                       limits = c(0, 0.8),
                       labels = scales::percent_format()) +
    labs(x = "weeks until Thanksgiving",
         y = "percent of wards") +
    theme_bw()
```

```{r}
#| label: fig-prop_wards_per_day
#| fig-cap: Percentage of wards that sing at least one Thanksgiving hymn by week
freqs %>%
    filter(country == "United States",
           month == 11) %>%
    left_join(thanksgiving_lookup, by = "year") %>%
    mutate(days_until = thanksgiving_day - date) %>%
    mutate(is_thanksgiving = hymn_num %in% c(91:95, 62, 241, 219)) %>%
    summarize(n_thanksgiving = sum(is_thanksgiving, na.rm = TRUE), .by = c(meeting_id, days_until)) %>%
    summarize(n = n(),
             include_thanksgiving = sum(n_thanksgiving > 0),
             .by = days_until) %>%
    mutate(prop = include_thanksgiving / n) %>%
    arrange(days_until) %>%
    # print()
    ggplot(aes(days_until, prop)) +
    geom_line() +
    geom_point() +
    scale_x_reverse() +
    scale_y_continuous(expand = expansion(0, c(0.01, 0.05)),
                       breaks = seq(0, 1, 0.1),
                       limits = c(0, 0.8),
                       labels = scales::percent_format()) +
    labs(x = "days until Thanksgiving",
         y = "percent of wards") +
    theme_bw()
# Here's a plot for days until, but I guess I don't have enough data across enough years to show the plot I wanted to
```


So, perhaps a better way to look at the data is to change the percentages. @fig-props_across_november shows the same data as @fig-within_november, but instead of the data within each panel adding up to 100%, the data within each week (4 weeks before, 3 weeks before, etc) add up to 100% across all eight panels. So, the way you interpret this is that given all the Thanksgiving hymns sung, for example, four weeks before Thanksgiving, a quarter of them will be <hymn>Because I Have Been Given Much (#219)</hymn>. Given all the Thanksgiving hymns the Sunday before Thanksgiving, about a quarter of them will be <hymn>Prayer of Thanksgiving (#93)</hymn>. So, the higher a number is on any one of these panels, the more typical it is for it to be sung that week. 

```{r, include = TRUE, fig.height = 6}
#| label: fig-props_across_november
#| fig-cap: The eight Thanksgiving hymns and the likihood of being sung across November weeks. 
weeks_until %>%
    arrange(hymn_num) %>% 
    mutate(name_num = fct_inorder(name_num)) %>%
    count(name_num, weeks_until) %>%
    mutate(prop = n/sum(n), .by = weeks_until) %>%
    
    # print() %>%
    ggplot(aes(weeks_until, prop, group = name_num)) + 
    geom_path() + 
    geom_point() + 
    scale_x_reverse() + 
    scale_y_continuous(expand = expansion(0, c(0.01, 0.05)),
                       breaks = seq(0, 0.6, 0.1),
                       limits = c(0, 0.3),
                       labels = scales::percent_format()) +
    facet_wrap(~name_num, ncol = 2) + 
    labs(x = "weeks until Thanksgiving",
         y = "percent") + 
    theme_bw()
```

So here, we see some, in my opinion, more interesting trends. Some hymns, like <hymn>Because I Have Been Given Much (#219)</hymn> and <hymn>For the Beauty of the Earth (#92)</hymn>, are more popular further from Thanksgiving, and get less popular leading up to it. [To be clear, the raw numbers in @fig-within_november show an increase through the month, but here we're focused on how often a hymn is selected, *given that it's one of these eight hymns being sung*, per week. I don't know, I think this plot shows a more accurate picture of my intuition.]{.aside} Other hymns are more common the closer it is to Thanksgiving. 

This chart reveals some additional insight into how music coordinators choose hymns. You're not likely to sing any one of these Thanksgiving hymns more than once in the Thanksgiving "season." So, the music coordinator is left to decide which hymns to choose and when to sing them during the month. We already saw in @fig-prop_wards_per_week that these hymns are more common the closer it is to Thanksgiving and that most wards sing maybe 2--4 of these. So, let's say a ward ends up with four of them. Well they can't sing them all in one week, so one of them will be pushed to the week prior. Which hymn does the music coordinator choose? I think what people think is that they don't want to "waste" the "good" hymn on an earlier week. Or rather, they save the "best" hymns for the preferred weeks. So, the "throwaway" hymns like <hymn>Because I Have Been Given Much (#219)</hymn>, <hymn>Count Your Blessings (#241)</hymn>, or even <hymn>Father, Thy Children to Thee Now Raise (#91)</hymn> are sung in the nonideal weeks, and ones like <hymn>Prayer of Thanksgiving (#93)</hymn> and <hymn>Come, Ye Thankful People (#94)</hymn> are reserved for the best week. We see the same thing around [Christmas time](/post/Christmas) too.

I think these patterns feed into each other. How does a music coordinator know which hymns are "best"? Experience in the church and general intuition is helpful, but I think words like *Thanksgiving* and *Thankful* that line up with the name of the holiday are almost guaranteed to make them quintessential. Imagine if there were a hymn that had the word "Valentine" in it, I think it'd be sung the week before Valentine's Day a *lot* and hardly ever any other week! So when a hymn becomes strongly associated with a holiday, they're likely to sing it the week prior to that holiday and *not* choose it any other week of the year, which is what we see in @fig-thanksgiving_annual with the annual trends for all hymns. The less quintessential ones are more flexible. 

Another potential factor that I haven't mentioned at all is that there is more to a sacrament meeting besides when in the year it happens. The topic of a particular sacrament meeting can often have a strong effect on what hymns are being sung. If topics are more or less random across wards, the topic-specific effects will cancel each other out. However, topics are often chosen based on proximity to holidays, and while I don't have the data to show this, I would suspect that many sacrament meetings in November are on the topic of Gratitude. So, especially earlier in the month when Thanksgiving itself is less on people's minds, a more general gratitude-related hymn is selected. But, the point I'm trying to make is that both sacrament meeting topics and hymns are often chosen because of holidays and they mutually reinforce each other to create these November-specific patterns discussed on this page.

## Patterns within Sacrament Meeting

I'll end this post with a look into patterns within Sacrament Meeting itself. Are these hymns likely to be sung as opening hymns, intermediate hymns, or closing hymns? @fig-type shows the eight Thanksgiving hymns and how often they occured within sacrament meeting. The totals in each panel add up to 100%.

```{r, include = TRUE, fig.height = 6}
#| label: fig-type
#| fig-cap: When each Thanksgiving hymn is sung within sacrament meeting.
freqs %>%
    filter(hymn_num %in% c(91:95, 62, 241, 219),
           month == 11, 
           country == "United States",
           !is.na(type)) %>%
    arrange(hymn_num) %>%
    mutate(name_num = fct_inorder(name_num)) %>%
    count(name_num, type) %>%
    mutate(prop = n/sum(n), .by = name_num) %>%
    ggplot(aes(type, prop)) + 
    geom_col() + 
    scale_y_continuous(expand = expansion(0, c(0.01, 0.05)),
                       breaks = seq(0, 1, 0.1),
                       # limits = c(0, 0.3),
                       labels = scales::percent_format()) +
    facet_wrap(~name_num, ncol = 2) + 
    theme_bw()
```

It seems like each hymn has its own story. Some hymns are most often sung as opening hymns, like <hymn>All Creates of Our God and King (#62)</hymn>, <hymn>Father, Thy Children to Thee Now Raise (#91)</hymn>, <hymn>Prayer of Thanksgiving (#93)</hymn>, and <hymn>Come, Ye Thankful People (#94)</hymn>. Just one, <hymn>Now Thank We All Our God (#95)</hymn> is most common as a closing hymn; it's not clear to me why that hymn shows that pattern. Others like <hymn>For the Beauty of the Earth (#92)</hymn> and <hymn>Because I Have Been Given Much (#219)</hymn> are equally split between bing opening hymns and closing hymns. Finally, <hymn>Count Your Blessings (#241)</hymn> is equally split between being opening and intermediate hymns, but is less likely to be a closing hymn. It seems like the most "Thanksgivingy" hymns are less likely to be intermediate hymns. But, I have no idea why these hymns show these patterns and I'm very curious to figure them out! It seems there is more to hymn selection than what can be explained in this dataset!

## Conclusion

In the United States, there are eight hymns that are sung mostly around Thanksgiving. The majority of wards sing between two and four of these hymns per year, but some sing as many as seven and others sing none at all. The Thanksgiving season starts in November and you're more likely to sing Thanksgiving hymns the closer you are to the holiday itself. The most "Thanksgivingy" hymns are most likely right before Thanksgiving. Some hymns are more commonly sung as opening hymns, but other hymns have their own patterns. Clearly, there is a lot that can be uncovered by just looking at hymns in November!


## Update: Thanksgiving in 2024

A year has passed and I thought I'd take a look at how the Thanksgiving season of 2024 has compared to the general trends reported in this post. In this section, I report on the 599 sacrament meetings I have from 204 wards. 

```{r}
nov2024 <- freqs2024 |> 
    filter(country == "United States",
           month == 11) |> 
    print()

nov2024 |> 
    count(meeting_id)
nov2024 |> 
    count(ward)
```

```{r, include = TRUE, fig.height = 3.5, fig.width = 6.5}
#| label: fig-thanksgiving_freqs2024
#| fig-cap: Most common hymns in November in 2024 (excluding sacrament hymns)
nov2024 |> 
    filter(!hymn_num %in% 169:196) |> 
    mutate(category = case_when(hymn_num %in% 91:95 ~ "canonical Thanksgiving",
                                hymn_num %in% c(62, 241, 219) ~ "honorary Thanksgiving",
                                TRUE ~ "other")) |> 
    cleveland_plot(col_to_plot = avg_per_year, 
               unique_meetings = get_n_distinct_meetings(nov2024), 
               n_weeks = length(unique(nov2024$date)),
               filter_n = 20, 
               extra_cols = category,
               color = category) + 
    scale_x_continuous(expand = expansion(0, c(0, 0.23)),
                       breaks = seq(0, 1, 0.2)) + 
    scale_color_manual(values = c("#08519c", "#6baed6", "gray20")) + 
    labs(title = "Most common hymns in November 2024 (in the United States)",
         subtitle = "Includes <span style = 'color: #4477AA;'>Hymns 91–95</span> and <span style = 'color: #4d4d4d;'>other hymns</span>",
         x = "average number of times sung per ward") + 
    theme(plot.subtitle = element_markdown(),
          legend.position = "none")
```

```{r}
compare_popularity <- function(.hymn_num) {
    pre2024_prop_of_meetings <- freqs %>%
        filter(month == 11, 
               country == "United States",
               !hymn_num %in% 169:196) %>%
        cleveland_plot(return = "table") |> 
        filter(hymn_num %in% .hymn_num) |> 
        pull(prop_of_meetings)
    
    just2024_prop_of_meetings <- freqs2024 %>%
        filter(month == 11, 
               country == "United States",
               !hymn_num %in% 169:196) %>%
        cleveland_plot(return = "table") |> 
        filter(hymn_num %in% .hymn_num) |> 
        pull(prop_of_meetings)
    
    return(just2024_prop_of_meetings/pre2024_prop_of_meetings)
}
compare_popularity(62)
compare_popularity(91)
```

There are a few differences in 2024 compared to what was described above. While the top five hymns are the same, <hymn>Now Thank We All Our God (#95)</hymn> is a little less popular this year compared to before. Also, <hymn>All Creatures of Our God and King (#62)</hymn> was about 20% less popular in 2024 as it was before, and <hymn>Father, Thy Children to Thee Now Raise (#91)</hymn> didn't even make it onto this chart because it was half as popular as before. What has taken their place? Several of the most popular new hymns (from the [first](/posts/new_hymns_batch1) and [second](/posts/new_hymns_batch2) batch) and two hymns that I think were popular in many [Primary Programs](/post/primary_program) this year. 


```{r}
wards_with_complete_months2024 <- freqs2024 %>%
    filter(month == 11, country == "United States",
           !ward %in% c("Unknown", "Anonymous")) %>%
    unite(month_year, month, year, remove = FALSE) %>%
    group_by(ward, month_year, date) %>%
    count() %>%
    group_by(ward, month_year) %>%
    count() %>%
    ungroup() %>%
    filter(n >= 4)
thanksgiving_hymns_per_ward2024 <- freqs2024 %>%
    filter(country == "United States",
           !ward %in% c("Anonymous")) %>%
    unite(month_year, month, year, remove = FALSE) %>%
    semi_join(wards_with_complete_months2024, by = c("ward", "month_year")) %>%
    group_by(ward, month_year) %>%
    summarize(one_of_the_five = sum(hymn_num %in% 91:95),
              one_of_the_eight = sum(hymn_num %in% c(91:95, 241, 219, 62)))
thanksgiving_hymns_per_ward2024 %>%
    ungroup() %>%
    count(one_of_the_five) %>%
    mutate(prop = n/sum(n)) |> 
    mutate(cumsum = cumsum(prop))
```


```{r, include = TRUE, fig.height = 4}
#| label: fig-n_hymns2024
#| fig-cap: How many Thanksgiving hymns did wards sing in November 2024?
five2024 <- thanksgiving_hymns_per_ward2024 %>%
    ungroup() %>%
    count(one_of_the_five) %>%
    mutate(prop = n/sum(n)) |> 
    rename(n_hymns_sung = one_of_the_five)
eight2024 <- thanksgiving_hymns_per_ward2024 %>%
    ungroup() %>%
    count(one_of_the_eight) %>%
    mutate(prop = n/sum(n))|> 
    rename(n_hymns_sung = one_of_the_eight)
fivepre2024 <- thanksgiving_hymns_per_ward %>%
    ungroup() %>%
    count(one_of_the_five) %>%
    mutate(prop = n/sum(n)) |> 
    rename(n_hymns_sung = one_of_the_five)
eightpre2024 <- thanksgiving_hymns_per_ward %>%
    ungroup() %>%
    count(one_of_the_eight) %>%
    mutate(prop = n/sum(n))|> 
    rename(n_hymns_sung = one_of_the_eight)
bind_rows(`one of the five before 2024` = fivepre2024,
          `one of the eight before 2024` = eightpre2024,
          `one of the five in 2024` = five2024, 
          `one of the eight in 2024` = eight2024,
          .id = "group") |> 
    mutate(group = fct_inorder(group)) |> 
    ggplot(aes(n_hymns_sung, prop)) + 
    geom_col() +
    geom_text(aes(label = scales::percent(prop)), size = 2, nudge_y = 0.02) +
    facet_wrap(~group) +
    scale_x_continuous(expand = expansion(0, 0.25),
                       breaks = 0:9) +
    scale_y_continuous(expand = expansion(0, c(0, 0.05)),
                       labels = scales::percent_format()) +
    labs(x = "number of Thanksgiving hymns sung in November",
         y = "percent of wards",
         caption = "The 'five' refer to hymns 91–95; the 'eight' refer to those plus 62, 241, and 241") +
    theme_bw()
```




In @fig-one_of_the_five and @fig-one_of_the_eight, I showed that typically a ward sings about two of the canonical Thanksgiving hymns and up to maybe four of the eight most Thanksgiving-related hymns per year. @fig-n_hymns2024 shows these same numbers (in the top two panels) together with their 2024 equivalents (in the bottom two panels). Beginning with the five canonical Thanksgiving hymns on the left, there were equal numbers of wards singing two or three of them. A few more just sang one and fewer wards sang more than three. When we add the three "honorary" Thanksgiving hymns in the right panels, we see a remarkably balanced distribution. A third of wards sang three of these eight hymns. About one in five each did two or four. And a less less sang just one or greater than five. Overall, 97% of wards that I have complete data from sang at least one of these eight hymns in in 2024, which is pretty cool. There were fewer wards singing six or more Thanksgiving hymns.

Overall, about 23.2% of all hymns sung in November before 2024 were one of the eight Thanksgiving hymns. In November 2024, the number is just slightly lower at 22.8%. The difference between these is not statistically significant ($\chi^2$ = 0.110, df = 1, $p$ = 0.74), meaning we're not singing fewer Thanksgiving hymns. Looking at @fig-n_hymns2024, I suspected that we might be singing fewer of the non-canonical Thanksgiving hymns and focusing on the canonical five, but the differences in those groups of hymns across years was also not significant. 

Basically, the overall trend is that we sang about the same number of Thanksgiving hymns this as we have in years past. I think the biggest change is that when non-Thanksgiving hymns are sung, they tend to be one of the new hymns rather than any other hymn.

```{r}
propThanksgiving_pre2024 <- freqs |> 
    filter(country == "United States",
           month == 11) |> 
    mutate(is_thanksgiving =hymn_num %in% c(91:95, 62, 219, 241)) |> 
    # mutate(prop = n/sum(n)) |> 
    print()
propThanksgiving_2024 <-freqs2024 |> 
    filter(country == "United States",
           month == 11) |> 
    mutate(is_thanksgiving = hymn_num %in% c(91:95, 62, 219, 241)) |> 
    # mutate(prop = n/sum(n)) |> 
    print()

bind_rows(`pre2024` = propThanksgiving_pre2024,
          `in2024`  = propThanksgiving_2024,
          .id = "year") |> 
    infer::chisq_test(is_thanksgiving ~ year)

propThanksgiving_2024 |> 
    count(is_thanksgiving) |> 
    mutate(prop = n/sum(n))
propThanksgiving_pre2024 |> 
    count(is_thanksgiving) |>
    mutate(prop = n/sum(n))
```

```{r}
propThanksgiving_pre2024 <- freqs |> 
    filter(country == "United States",
           month == 11) |> 
    mutate(is_thanksgiving = hymn_num %in% c(62, 219, 241)) |> 
    # mutate(prop = n/sum(n)) |> 
    print()
propThanksgiving_2024 <-freqs2024 |> 
    filter(country == "United States",
           month == 11) |> 
    mutate(is_thanksgiving = hymn_num %in% c(62, 219, 241)) |> 
    # mutate(prop = n/sum(n)) |> 
    print()

bind_rows(`pre2024` = propThanksgiving_pre2024,
          `in2024`  = propThanksgiving_2024,
          .id = "year") |> 
    infer::chisq_test(is_thanksgiving ~ year)

propThanksgiving_2024 |> 
    count(is_thanksgiving) |> 
    mutate(prop = n/sum(n))
propThanksgiving_pre2024 |> 
    count(is_thanksgiving) |>
    mutate(prop = n/sum(n))
```




