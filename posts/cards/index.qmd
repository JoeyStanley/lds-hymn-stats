---
title: "How many of each card shhould a ward have?"
author: "Joey Stanley"
date: 2024-08-23
date-modified: last-modified
categories:
  - frequency
image: cover.png
---

```{r, include = FALSE}
knitr::opts_chunk$set(include = FALSE,
                      echo = FALSE)
rmarkdown::render("../../_scripts/analysis_functions.Rmd")
library(gt)
library(scales)
library(tidytext)
```


```{r}
this_df <- freqs |> 
    filter(date <= ymd("2024-06-01"),
           !ward %in% c("Anonymous", "NA", "Unkonwn"),
           !is.na(ward),
           !str_detect(ward, "Stake"),
           !str_detect(ward, "District"),
           hymn_num %in% 1:341) |> 
    add_count(meeting_id) |> 
    filter(n %in% 3:4) |> 
    select(meeting_id, hymn_num)
n_meetings_comma <- scales::comma(length(unique(this_df$meeting_id)))
```


I've never had a calling where I was the one to put the cards on the display to show the hymn numbers. I also have no idea how many of each card is in a pack you get from Distribution. But, with the data I have, I can now provide some recommendations on how many of each digit a pack of cards has because have a pretty good idea of how many cards wards have had to use. So, let's take a look at what we can learn. This post is based on data from `r n_meetings_comma` wards prior to June 2 when the new hymns were released since those 1000s throw everything off!

## Number of digits on display

First, let's take a look at the distribution of numbers across all the hymns in these sacrament meetings. This table shows what percentage of the cards displayed belonged to each number.

```{r, include = TRUE}
this_df |> 
    mutate(hymn_num = as.character(hymn_num)) |> 
    unnest_characters(digit, hymn_num) |> 
    count(digit) |>
    mutate(prop = scales::percent(n/sum(n))) |>
    rename(percent = prop) |>
    select(-n) |> 
    gt()
```

It shouldn't come as too much of a surprise that the most common digit is 1. After all, the sacrament hymns all include at least one of them. I guess what's surprising is *just* how much more common it is. It's almost five times as common as 5 for some reason. We can plot these numbers. Here's a plot to show these visually, which highlights the difference between them. Interestingly, the numbers 7--9 are slightly more common, probably because they're used in the sacrament hymns which are hymns 169--196.

```{r, include = TRUE, fig.height = 4, fig.width = 8}
this_df |> 
    mutate(hymn_num = as.character(hymn_num)) |> 
    unnest_characters(digit, hymn_num) |> 
    count(digit) |>
    mutate(prop = n/sum(n),
           prop_percent = percent(prop)) |>
    ggplot(aes(digit, prop)) + 
    geom_col() + 
    geom_text(aes(label = prop_percent), nudge_y = 0.01) +
    scale_y_continuous(minor_breaks = seq(0, 0.5, 0.01),
                       labels = percent,
                       expand = expansion(0, c(0, 0.01))) + 
    labs(title = "Distribution of digits on the hymn number displays",
         subtitle = paste0("Based on ", n_meetings_comma, " sacrament meetings"),
         y = "percent") + 
    theme_minimal() + 
    theme(axis.text.x = element_text(size = 15))
```

## Which digits are most common?

So now what we can do is rather than look at all the data at once, we could look at each sacrament meeting individually. If a quarter of the cards used are 1s, and the most number of cards used on a typical sacrament meeting is twelve (four hymns, each with three digits), then about three of them are predicted to be 1s. Let's see what the data actually shows though.

First off, the following plot shows the distribution how many cards are used each week. About 37% of meetings have nine digits on display. You'd see this if you didn't sing an intermediate hymn and all three hymns that were sung were hymn 100--341. Another 19% have eight digits, which would mean one of the three hymns is between 11 and 99. Just a few wards only displayed five digits, which happens when the opening and closing hymn are between 1 and 9 and a typical sacrament hymn.

```{r, include = TRUE, fig.height = 4, fig.width = 8}
this_df |> 
    mutate(hymn_num = as.character(hymn_num)) |> 
    unnest_characters(digit, hymn_num) |> 
    count(meeting_id, name = "total_cards") |> 
    count(total_cards, name = "n_meetings") |> 
    mutate(prop = n_meetings/sum(n_meetings),
           prop_percent = percent(prop)) |> 
    ggplot(aes(total_cards, prop)) + 
    geom_col() +
    geom_text(aes(label = prop_percent), nudge_y = 0.015) + 
    scale_x_continuous(breaks = 1:20, 
                       minor_breaks = NULL) + 
    scale_y_continuous(labels = percent,
                       expand = expansion(0, c(0, 0.01))) +
    labs(title = "Distribution of number of cards on the hymn number displays",
         subtitle = paste0("Based on ", n_meetings_comma, " sacrament meetings"),
         x = "total number of cards used",
         y = "percent") + 
    theme_minimal()
```

The plot above shows that, once in a very great while, you might see a sacrament meeting with only four cards used. This happened twice in my dataset. Both from the same ward in American Fork in March 2021. On one week, they sang <hymn>Dearest Children, God Is Near You (#96)</hymn> as the sacrament hymn and on the next week, they sang <hymn>For the Beauty of the Earth (#92)</hymn> as the sacrament hymn. It is [very unusual](/posts/sacrament) to sing anything outside of hymns 169--196. But, as rare as it is to do that, what makes these doubly unusual is that both the opening and closing hymns were one of the nine hymns between 1 and 9. That means only four digits were on display. Pretty cool. Not sure what was going on in that ward, but it's pretty cool that I caught it happening.

```{r}
this_df |> 
    mutate(hymn_num = as.character(hymn_num)) |> 
    unnest_characters(digit, hymn_num) |> 
    count(meeting_id) |> 
    filter(n <= 4) |> 
    print()
freqs |> 
    filter(meeting_id == "2021-03-14 American Fork 26th Ward")
freqs |> 
    filter(meeting_id == "2021-03-21 American Fork 26th Ward")
```

Going back to the individual digits, we can now go back and see how many of each are on display each week in a ward. I looked through all the sacrament meetings I have data from, and counted up how many of each digit was on display. I then took the average across all meetings. Those averages are displayed in this plot below. I know it's nonsensical to think of 2.2 cards, but these are averages after all. 

```{r}
this_df |> 
    mutate(hymn_num = as.character(hymn_num)) |> 
    unnest_characters(digit, hymn_num) |> 
    count(digit, meeting_id) |> 
    summarize(mean_digits = mean(n), .by = digit) |> 
    ggplot(aes(digit, mean_digits)) + 
    geom_col() + 
    geom_text(aes(label = round(mean_digits, 3)), nudge_y = 0.07) +
    scale_y_continuous(expand = expansion(0, c(0, 0.06))) +
    labs(title = "Average number of each digit on the hymn number displays",
         subtitle = paste0("Based on ", n_meetings_comma, " sacrament meetings"),
         x = "digit",
         y = "average number of cards") +
    theme_minimal() + 
    theme(axis.text.x = element_text(size = 15))
```

## How many of each digit should come in a pack?

However, this plot is the same as the one above that showed the proportion of numbers on display across all meetings. So, let's make it more useful. What if we consider a different question. How many copies of each digit should come in a standard pack distributed by the church? You probably don't need twelve of each number because you're never going to sing hymn 111 four times. But you want more than what the numbers in the above plot show, because it means half the time you won't have enough. 

What I've done is looked at how many copies of each digit are needed to account for 95% of sacrament meetings. Those numbers are displayed below. What this plot shows is that if you have four 1s and 2s, three 0s, 3s, 7s, and 9s, and two 4s, 5s, 6s, and 8s, you would have enough cards 95% of the time. That means it's only about every two years that you'd run out of cards. 

```{r}
this_df |> 
    mutate(hymn_num = as.character(hymn_num)) |> 
    unnest_characters(digit, hymn_num) |> 
    count(digit, meeting_id) |> 
    summarize(n = quantile(n, 0.95), .by = digit) |>
    ggplot(aes(digit, n)) +
    geom_col() + 
    scale_y_continuous(expand = expansion(0, c(0, 0.06))) +
    labs(title = "How many cards of each digit needed for 95% of sacrament meetings.",
         y = "number of cards") +
    theme_minimal() + 
    theme(axis.text.x = element_text(size = 15))
```

Howevever, once every two years is still more often that you'd want. Perhaps what we'd want is to be good 99% of the time. The plot below shows those numbers. This time, you'd need five 1s and 2s, four 3s, and three of everything else. That would ensure you're good to go almost all the time and maybe once every five years would you run out. 

```{r}
this_df |> 
    mutate(hymn_num = as.character(hymn_num)) |> 
    unnest_characters(digit, hymn_num) |> 
    count(digit, meeting_id) |> 
    summarize(n = quantile(n, 0.99), .by = digit) |>
    ggplot(aes(digit, n)) +
    geom_col() + 
    scale_y_continuous(expand = expansion(0, c(0, 0.06))) +
    labs(title = "How many cards of each digit needed for 99% of sacrament meetings.",
         y = "number of cards") +
    theme_minimal() + 
    theme(axis.text.x = element_text(size = 15))
```

Perhaps that's sufficient. But maybe not. For the sake of curiosity, how many cards would it take to cover *all* the sacrament meetings I have data for? The plot below shows those numbers. You'd need a whopping eight 1s, seven 2s, six each of 3s, 6s, and 7s, and five of everything else. 

```{r}
this_df |> 
    mutate(hymn_num = as.character(hymn_num)) |> 
    unnest_characters(digit, hymn_num) |> 
    count(digit, meeting_id) |> 
    summarize(n = max(n), .by = digit) |>
    ggplot(aes(digit, n)) +
    geom_col() + 
    scale_y_continuous(expand = expansion(0, c(0, 0.06))) +
    labs(title = "How many cards of each digit needed all sacrament meetings.",
         y = "number of cards") +
    theme_minimal() + 
    theme(axis.text.x = element_text(size = 15))
```

For the 1s, yes, there was a sacrament meeting that used eight of them. It was a ward in Maryland in 2017 and they sang <hymn>Rock of Ages (#111)</hymn>, <hymn>Again, Our Dear Redeeming Lord (#179)</hymn>, <hymn>I'm a Pilgrim, I'm a Stranger (#121)</hymn>, and <hymn>Our Savior's Love (#113)</hymn>. So, nothing particularly special I don't think, but it just so happens that they had a lot of 1s. They could theoretically have had a ninth 1 if they had sung <hymn>With Humble Heart (#171)</hymn>, <hymn>Jesus of Nazareth, Savior and King (#181)</hymn>, or <hymn>Behold the Great Redeemer Die (#191)</hymn> as the sacrament hymn. So I think the most you'd see for any number is nine. 

```{r}
this_df |> 
    mutate(hymn_num = as.character(hymn_num)) |> 
    unnest_characters(digit, hymn_num) |> 
    count(digit, meeting_id) |> 
    filter(digit == 1, n == 8)

freqs |> 
    filter(meeting_id == "2017-04-23 Pasadena Ward")
```

You'd in theory need 




```{r}
this_df |> 
    mutate(hymn_num = as.character(hymn_num)) |> 
    unnest_characters(digit, hymn_num) |> 
    count(digit, meeting_id) |> 
    filter(digit == 2, n == 7)

freqs |> 
    filter(meeting_id == "2015-08-16 Hammond Ward")
freqs |> 
    filter(meeting_id == "2015-11-29 Centerville 9th Ward")

```

Two sacrament meetings used seven 2s. This was mostly done by singing multiple hymns in the 220-229 range. But the most possible I suppose would be eight, if you sang the rather unusual hymn <hymn>Hear Thou Our Hymn, O Lord (#222)</hymn>, a sacrament hymn ending in 2, and two others each with two 2s. I saw six threes one time; it was around the 4th of July and they sang <hymn>America the Beautiful (#338)<hymn> and <hymn>My Country, 'Tis of Thee (#339)</hymn>, and both of the other hymns had one three in it. Unless you're singing the Men's Choir version of <hymn>High on the Mountain Top (#333)</hymn> or another hymn in the 330s, it's only really possible to get just one more, for a maximum of seven. 

```{r}
this_df |> 
    mutate(hymn_num = as.character(hymn_num)) |> 
    unnest_characters(digit, hymn_num) |> 
    count(digit, meeting_id) |> 
    filter(digit == 3, n == 6)

freqs |> 
    filter(meeting_id == "2018-07-08 Taylorsville Gardens Ward")
```


```{r}
this_df |> 
    mutate(hymn_num = as.character(hymn_num)) |> 
    unnest_characters(digit, hymn_num) |> 
    count(digit, meeting_id) |> 
    filter(digit == 7, n == 6)

freqs |> 
    filter(meeting_id == "2022-02-20 Fort Meade Ward")
```


The other digits 





```{r}
# digits |> 
#     ggplot(aes(n)) + 
#     geom_bar() + 
#     scale_x_continuous(breaks = seq(0:10))
```

```{r}
# digits |> 
#     add_count(n) |> 
#     filter(n == 8)
# freqs |> 
#     filter(meeting_id == "2017-04-23 Pasadena Ward")
```

